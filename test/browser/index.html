<!DOCTYPE html>
<html>

  <head>

  </head>

  <body>
    <p>Watch the data load incrementally. Status: <span id="display-status">waiting</span></p>
    <p id="display-content" style="font-size: 10px;">Nothing yet...</p>

    <script src="superagent-get-chunked.js"></script>
    <script>
      var inputs = [{
        accept: 'text/tab-separated-values',
        url: 'http://webservice.bridgedb.org/Human/xrefs/L/4292',
        fontSize: '5px',
      }, {
        // large file!
        accept: 'tsv',
        url: 'https://cdn.rawgit.com/nrnb/mirna-pathway-finder/master/wp-mir-table-builder/mir-gene-targets.txt',
        fontSize: '5px',
      }, {
        accept: 'json',
        url: 'https://publicdata-weather.firebaseio.com/sanfrancisco/.json',
        fontSize: '8px',
      }, {
        accept: 'ndjson',
        url: 'https://cdn.rawgit.com/maxogden/sqlite-search/master/test.ndjson',
        fontSize: '4px',
      }, {
        accept: 'n3',
        url: 'https://cdn.rawgit.com/simeonackermann/VocTo/master/data/example.n3',
        fontSize: '12px',
      }, {
        // large file!
        accept: 'n3',
        url: 'https://cdn.rawgit.com/ruby-rdf/rdf-n3/develop/example-files/sp2b.n3',
        fontSize: '5px',
      }, {
        accept: 'xml',
        url: 'https://cdn.rawgit.com/wikipathways/pvjs/master/test/input-data/troublesome-pathways/WP1243_69897.gpml',
        fontSize: '10px',
      }, {
        accept: 'xml',
        url: 'https://cdn.rawgit.com/jmandel/sample_ccdas/master/HL7%20Samples/CCD.sample.xml',
        fontSize: '10px',
      }];

      var selectedInput = inputs[7];

      var status = 'loading';
      var statusP = document.querySelector('#display-status');

      statusP.textContent = status + ' at ' + new Date().toISOString();

      function showStatus() {
        if (status === 'loading') {
          window.requestAnimationFrame(function() {
            statusP.textContent = status + ' at ' + new Date().toISOString();
            showStatus();
          });
        }
      }
      showStatus();

      var contentP = document.querySelector('#display-content');

      contentP.style.fontSize = selectedInput.fontSize;
      contentP.style.backgroundColor = 'lightgreen';

      request
      .get(selectedInput.url)
      .accept(selectedInput.accept)
      .on('data', function(data) {
        contentP.textContent = JSON.stringify(data);
      })
      .on('error', function(err) {
        throw err;
      })
      .on('end', function() {
        status = 'complete';
        statusP.textContent = status;
      })
      .end();
    </script>
  </body>

</html>
